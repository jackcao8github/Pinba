<!DOCTYPE html>
<html manifest="pinba.appcache">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width" />

<link rel="stylesheet" href="css/jquery.mobile-1.4.5.css" />
<link rel="stylesheet" href="css/photoswipe.css" />
<link rel="stylesheet" href="css/font-awesome.css" />
<script src="js/jquery-1.7.1.min.js"></script>
<!-- 支持jquery.event.drag-1.5.min.js中的图片手动滑动 -->
<script src="js/jquery.mobile-1.4.5.js"></script>
<script type="text/javascript" src="js/jquery.event.drag-1.5.min.js"></script>
<script type="text/javascript" src="js/jquery.touchSlider.js"></script>

<script type="text/javascript" src="js/mydownandupslide.js"></script>
<script type="text/javascript">
	$(document)
			.ready(
					function() {
						//图片滚动处理 ------------------------------start
						$(".main_visual").hover(function() {

						}, function() {

						});

						$dragBln = false;

						$(".main_image").touchSlider(
								{
									flexible : true,
									speed : 200,
									btn_prev : $("#btn_prev"),
									btn_next : $("#btn_next"),
									paging : $(".flicking_con a"),
									counter : function(e) {
										$(".flicking_con a").removeClass("on")
												.eq(e.current - 1).addClass(
														"on");
									}
								});

						$(".main_image").bind("mousedown", function() {
							$dragBln = false;
						});

						$(".main_image").bind("dragstart", function() {
							$dragBln = true;
						});

						$(".main_image a").click(function() {
							if ($dragBln) {
								return false;
							}
						});

						timer = setInterval(function() {
							$("#btn_next").click();
						}, 5000);

						$(".main_visual").hover(function() {
							clearInterval(timer);
						}, function() {
							timer = setInterval(function() {
								$("#btn_next").click();
							}, 5000);
						});

						$(".main_image").bind("touchstart", function() {
							clearInterval(timer);
						}).bind("touchend", function() {
							timer = setInterval(function() {
								$("#btn_next").click();
							}, 5000);
						});
						//图片滚动处理 ------------------------------end
						if (navigator.geolocation) {
							// getCurrentPosition支持三个参数
							// getSuccess是执行成功的回调函数
							// getError是失败的回调函数
							// getOptions是一个对象，用于设置getCurrentPosition的参数
							// 后两个不是必要参数
							var getOptions = {
								//是否使用高精度设备，如GPS。默认是true
								enableHighAccuracy : true,
								//超时时间，单位毫秒，默认为0
								timeout : 5000,
								//使用设置时间内的缓存数据，单位毫秒
								//默认为0，即始终请求新数据
								//如设为Infinity，则始终使用缓存数据
								maximumAge : 0
							};
							navigator.geolocation.getCurrentPosition(
									showPosition, showErr, getOptions);
						} else {
							alert('Your browser does not support navigator.geolocation!')
						}
					});

	function myTouchEnd(ev){
		var endX, endY;
		endX = ev.changedTouches[0].pageX;
		endY = ev.changedTouches[0].pageY;
		var direction = GetSlideDirection(startX, startY, endX, endY);
		console.log("touchend,endX="+endX+"endY="+endY);
		switch (direction) {
		case 0:
			console.log("没滑动");
			break;
		case 1:
			console.log("向上");
			addOfferLi();
			break;
		case 2:
			console.log("向下");
			break;
		case 3:
			console.log("向左");
			break;
		case 4:
			console.log("向右");
			break;
		default:
		}
	}
	

	function addOfferLi() {
		$('#yourLike').html("猜你喜欢....");
		if ($(document).scrollTop() >= $(document).height()
				- $(window).height()) {
			console.log("滚动条已经到达底部为" + $(document).scrollTop());
			var newhtml = '<div class="+class+">';
			newhtml += '<a href="foodDetail.html?offerId=+offerid+" data-ajax="false"> <img src="http://image.zhangxinxu.com/image/study/s/s128/mm5.jpg" ';
     		newhtml+= 'class="bigImg" alt="Ballade">';

			newhtml += '<div class="title">+name+</div>';
			newhtml += '<div class="price"><i class="fa fa-rmb"></i>+price+</div>';
			newhtml += '	</a>';
			newhtml += '	<div style="float: left;">';
			newhtml += '<img class="smallimg" src="image/tuan_review_good.png"><span';
     		newhtml+='	style="font-size: 0.8em">335</span> </img>';
			newhtml += '</div>';

			newhtml += '<div style="margin-left: 10px; float: left;">';
			newhtml += '	<img class="smallimg"';
     		newhtml+='		src="image/my_favorite_user_icon_normal.png"><span';
     		newhtml+='		style="font-size: 0.8em">3350</span> </img>';
			newhtml += '</div>';
			newhtml += '</div>';

			for ( var i = 0; 10 > i; i++) {
				var leftli = newhtml.replace('+class+', 'offerleftli').replace(
						'+name+', '糖醋鱼' + i).replace('+price+', '30' + i);
				var rightli = newhtml.replace('+class+', 'offerrightli')
						.replace('+name+', '红烧排骨' + i).replace('+price+',
								'40' + i).replace('+offerid+', i);
				$('#yourLikeDiv').append(leftli);
				$('#yourLikeDiv').append(rightli);
			}
		}
	}

	function showPosition(position) {
		// ak = appkey 访问次数流量有限制
		$
				.getJSON(
						'http://api.map.baidu.com/geocoder/v2/?callback=?&ak=71709218d45a706b9c7e3abc2f037b23&location='
								+ position.coords.latitude
								+ ','
								+ position.coords.longitude
								+ '&output=json&pois=1', function(res) {
							//addressComponent =&gt; {city: "广州市", district: "天河区", province: "广东省", street: "广州大道", street_number: "中922号-之101-128"} 
							$("#location").html(
									res.result.addressComponent.city);
						});
	}
	function show(msg) {
		alert(msg)
	}
	function showErr(error) {
		var result;
		switch (error.code) {
		case error.PERMISSION_DENIED:
			result = "User denied the request for Geolocation."
			break;
		case error.POSITION_UNAVAILABLE:
			result = "Location information is unavailable."
			break;
		case error.TIMEOUT:
			result = "The request to get user location timed out."
			break;
		case error.UNKNOWN_ERROR:
			result = "An unknown error occurred."
			break;
		}
		//alert(result);
	}
</script>

</head>
<style type="text/css">
.offerleftli {
	margin: 1px 0;
	border: 1px solid #bebebe;
	height: auto;
	width: 49%;
	float: left;
	text-align: center;
}

.offerrightli {
	margin: 1px 0;
	border: 1px solid #bebebe;
	height: auto;
	width: 49%;
	float: right;
	text-align: center;
}

/* 列表中大图片 */
.bigImg {
	display: inline;
	margin: 1px;
	border: 1px solid #bebebe;
	height: 100%;
	width: 100%;
	background-size: contain;
}
/* 列表中小图片 */
.smallimg {
	height: 0.8em;
	width: 0.8em;
	display: auto;
	margin-left: 5px;
	border: 0;
}

div.img a:hover img {
	border: 1px solid #333333;
}

div.title {
	text-align: left;
	font-weight: normal;
	width: 140px;
	font-size: 12px;
	margin: 0px 5px 0px 5px;
}

div.price {
	text-align: left;
	font-weight: bold;
	width: 140px;
	font-size: 12px;
	margin: 5px 5px 0px 5px;
	color: red
}

.h10 {
	height: 10px;
	background: #f0f0f0;
}
#searchBox {
	padding-top: 0px;
	font-size: 0.8em
}
</style>

</head>
<body>
	<div data-role="page" id="homePage" style="top: -20px;">
		<div data-role="header" data-position="fixed" data-fullscreen="false"
			data-tap-toggle="false" id="homeHeader">
			<a href="#" data-role="button" id="location">城市</a>
			<!-- <h1>欢迎使用xx</h1> -->
			<h3 id="searchBox">
				<input id="searchCond" type="search" placeholder="商品名称..">
			</h3>
			<a href="message.html" data-role="button" data-icon="mail" target="_top"
				data-ajax="false" id="messageCnt">10</a>
		</div>
		<div class="main_visual">
			<div class="flicking_con">
				<a href="#">1</a> <a href="#">2</a> <a href="#">3</a> <a href="#">4</a>
				<a href="#">5</a>
			</div>
			<div class="main_image">
				<ul>
					<li><img src="images/img_main_1.jpg"></li>
					<li><img src="images/img_main_2.jpg"></li>
					<li><img src="images/img_main_3.jpg"></li>
					<li><img src="images/img_main_4.jpg"></li>
					<li><img src="images/img_main_5.jpg"></li>
				</ul>
				<a href="javascript:;" id="btn_prev" style="display: none;"></a> <a
					href="javascript:;" id="btn_next" style="display: none;"></a>
			</div>
		</div>
		<div class="h10"></div>
		<div class="ui-grid-b">
			<div class="ui-block-a" style="text-align: center;" id="foodDiv">
				<a class="ui-bar ui-bar-a"
					style="height: 70px; border: 0; background-color: #fff;"
					href="foodMain.html" data-ajax="false"> <img
					src="image/firstpage/food_u.png"
					style="background-size: contain; height: 80%; background-color: #fff"></img>
					<p style="margin: 0px">美食</p>
				</a>
			</div>
			<div class="ui-block-b" style="text-align: center;" id="workDiv">
				<a class="ui-bar ui-bar-a"
					style="height: 70px; border: 0; background-color: #fff;"
					href="workMain.html" data-ajax="false"> <img
					src="image/firstpage/boy_o.png"
					style="background-size: contain; height: 80%;"></img>
					<p style="margin: 0px">工作</p>
				</a>
			</div>
			<div class="ui-block-c" style="text-align: center;"
				id="entertainmentDiv">
				<a class="ui-bar ui-bar-a"
					style="height: 70px; border: 0; background-color: #fff;"
					href="entertainmentMain.html" data-ajax="false"> <img
					src="image/firstpage/entertainment_o.png"
					style="background-size: contain; height: 80%;"></img>
					<p style="margin: 0px">娱乐</p>
				</a>
			</div>

		</div>
		<div class="h10"></div>
		<p style="margin: 0 5px; text-align: center;" id="yourLike">猜你喜欢</p>

		<div id="yourLikeDiv">
			<div class="offerleftli">
				<a href="foodDetail.html?offerId=1" data-ajax="false" target="_top"> <img
					src="image/funlife/funlife02.jpg" class="bigImg" alt="Ballade">

					<div class="title">酸菜鱼</div>
					<div class="price">
						<i class="fa fa-rmb"></i>100
					</div>
				</a>
				<div style="margin-left: 5px; float: left;">
					<img class="smallimg" src="image/tuan_review_good.png"><span
						style="font-size: 0.8em">335</span> </img>
				</div>

				<div style="margin-left: 10px; float: left;">
					<img class="smallimg" src="image/my_favorite_user_icon_normal.png"><span
						style="font-size: 0.8em;">3350</span> </img>
				</div>
			</div>


			<div class="offerrightli">
				<a href="foodDetail.html?offerId=2" data-ajax="false"> <img
					src="image/funlife/funlife03.jpg" class="bigImg" alt="Ballade">

					<div class="title">糖醋鱼</div>
					<div class="price">
						<i class="fa fa-rmb"></i>100
					</div>
				</a>
				<div style="float: left;">
					<img class="smallimg" src="image/tuan_review_good.png"><span
						style="font-size: 0.8em">335</span> </img>
				</div>

				<div style="margin-left: 10px; float: left;">
					<img class="smallimg" src="image/my_favorite_user_icon_normal.png"><span
						style="font-size: 0.8em">3350</span> </img>
				</div>
			</div>
			<div class="offerleftli">
				<a href="foodDetail.html?offerId=3" data-ajax="false"> <img
					src="image/funlife/funlife02.jpg" class="bigImg" alt="Ballade">

					<div class="title">酸菜鱼</div>
					<div class="price">
						<i class="fa fa-rmb"></i>100
					</div>
				</a>
				<div style="float: left;">
					<img class="smallimg" src="image/tuan_review_good.png"><span
						style="font-size: 0.8em">335</span> </img>
				</div>

				<div style="margin-left: 10px; float: left;">
					<img class="smallimg" src="image/my_favorite_user_icon_normal.png"><span
						style="font-size: 0.8em;">3350</span> </img>
				</div>
			</div>


			<div class="offerrightli">
				<a href="foodDetail.html?offerId=4" data-ajax="false"> <img
					src="image/funlife/funlife03.jpg" class="bigImg" alt="Ballade">

					<div class="title">糖醋鱼</div>
					<div class="price">
						<i class="fa fa-rmb"></i>100
					</div>
				</a>
				<div style="float: left;">
					<img class="smallimg" src="image/tuan_review_good.png"><span
						style="font-size: 0.8em">335</span> </img>
				</div>

				<div style="margin-left: 10px; float: left;">
					<img class="smallimg" src="image/my_favorite_user_icon_normal.png"><span
						style="font-size: 0.8em">3350</span> </img>
				</div>
			</div>

		</div>
		<div id="bottom"></div>


		<div data-role="popup" id="addFavorite" data-overlay-theme="b"
			class="ui-content" style="max-width: 340px; padding-bottom: 2em;">
			<h3>Purchase Album?</h3>
			<p>Your download will begin immediately on your mobile device
				when you purchase.</p>
			<a href="#"
				class="ui-btn ui-btn-b ui-btn-inline ui-mini ui-corner-all ui-shadow ui-btn-icon-left ui-icon-check"
				data-rel="back">Buy: $10.99</a> <a href="#"
				class="ui-btn ui-btn-inline ui-mini ui-corner-all ui-shadow"
				data-rel="back">Cancel</a>
		</div>


		<div data-role="footer" data-position="fixed" data-tap-toggle="false">
			<div data-role="navbar" data-grid="d">
				<ul>
					<li><a id="homeBtn" href="home.html" data-icon="home"  data-ajax="false"
						class="ui-btn-active">首页</a></li>
					<li><a id="pinleBtn" href="pinle.html" data-icon="bars"  data-ajax="false">拼乐</a></li>
					<li><a id="fabuBtn" href="fabu.html" data-icon="grid"  data-ajax="false">发布</a></li>
					<li><a id="faxianBtn" href="faxian.html" data-icon="eye"  data-ajax="false">发现</a></li>
					<li><a id="wodeBtn" href="wode.html" data-icon="phone"  data-ajax="false">我的</a></li>
				</ul>
			</div>
		</div>
	</div>
</body>
</html>