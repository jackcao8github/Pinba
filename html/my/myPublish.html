<!DOCTYPE html>
<html manifest="../pinba.appcache">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width" />
<link rel="stylesheet" href="../css/jquery.mobile-1.4.5.css" />
<script src="../js/jquery-1.11.3.js"></script>
<script src="../js/jquery.mobile-1.4.5.js"></script>
<script type="text/javascript" src="../myjs/myswipe.js"></script>
<script src="../myjs/mycommon.js"></script>


<style>

</style>

<script type="text/javascript">
$(document).ready(
        function() {
        	getWorkList();
        });
function swipeRight(){
	closeSubPage();
}
function openWorkDetail(obj) {
	var workId = $(obj).attr('workId');
	changeSubPage('workDetail', 'myPubPage', 'workId=' + workId);
}

function openReqWorkDetail(obj){
	var workId = $(obj).attr('workId');
    changeSubPage('reqWorkDetail', 'myPubPage', 'workId=' + workId);
}

function getWorkList() {
    $('#workListUL').html('');
    var workInfo = {};
    var cachedUserInfo = str2Json(localStorage.userInfo);
    if (cachedUserInfo != null) {
        workInfo.userId = cachedUserInfo.userId;
        workInfo.userToken = cachedUserInfo.userToken;
        workInfo.page = '1';
        workInfo.workType = 'partTime,fullTime';//兼职/全职招聘

        ajaxReq('workAction', {
            method : 'getWorkList',
            workInfo : json2Str(workInfo)
        }, function(data) {
            if (data.flag != 'fail') {
                var lihtmls = '';
                for(var i=0;data.length>i;i++){
                    var workObj = data[i];
                    var lihtml = '<li><a onclick="openWorkDetail(this)" workId="'+workObj.workId+'"><h3>'+workObj.workName+'</h3><p>'+workObj.workType+'</p><p>发布时间:'+workObj.createDate+',失效时间:'+workObj.expDate+'</p></a></li>';
                    lihtmls += lihtml;
                }
                $('#workListUL').append(lihtmls);
                $('#workListUL').listview("refresh");
            } else {
                alert(data.msg);
            }
        });
    }
}

function getReqWorkList() {
    $('#reqWorkListUL').html('');
    var workInfo = {};
    var cachedUserInfo = str2Json(localStorage.userInfo);
    if (cachedUserInfo != null) {
        workInfo.userId = cachedUserInfo.userId;
        workInfo.userToken = cachedUserInfo.userToken;
        workInfo.page = '1';
        workInfo.workType = 'reqPartTime,reqFullTime';//兼职/全职类求职

        ajaxReq('workAction', {
            method : 'getWorkList',
            workInfo : json2Str(workInfo)
        }, function(data) {
            if (data.flag != 'fail') {
                var lihtmls = '';
                for(var i=0;data.length>i;i++){
                    var workObj = data[i];
                    var lihtml = '<li><a onclick="openReqWorkDetail(this)" workId="'+workObj.workId+'"><h3>'+workObj.workName+'</h3><p>'+workObj.workType+'</p><p>发布时间:'+workObj.createDate+',失效时间:'+workObj.expDate+'</p></a></li>';
                    lihtmls += lihtml;
                }
                $('#reqWorkListUL').append(lihtmls);
                $('#reqWorkListUL').listview("refresh");
            } else {
                alert(data.msg);
            }
        });
    }
}
</script>
</head>
<body>
	<div data-role="page" id="myPubPage">
		<div data-role="header" data-position="fixed" data-fullscreen="false">
			<!-- 返回按钮 -->
			<a href="#" data-rel="back"
				class="ui-btn ui-btn-left ui-alt-icon ui-nodisc-icon ui-corner-all ui-btn-icon-notext ui-icon-carat-l" onclick="closeSubPage();return false;">Back</a>

			<h1>我的发布记录</h1>
		</div>
		<div id="tabs" data-role="tabs">
			<div data-role="navbar">
				<ul>
					<li><a href="#workList" class="ui-btn-active"
						id="">招聘</a></li>
					<li><a href="#reqworkList" onclick="getReqWorkList()">求职</a></li>
					<!-- <li><a href="#messageList"
						id="messageTabLi">商品</a></li>
					<li><a href="#friendList">拼活动</a></li> -->
				</ul>
			</div>

			<div id="workList">
				<ul data-role="listview" id="workListUL">
					<li data-icon="false"><a onclick="openWork(this)" workid="1"
						style="padding-top: 0px; padding-bottom: 0px;"> <img
							src="http://image.zhangxinxu.com/image/study/s/s128/mm5.jpg">
							<h2>臻洪</h2> <!-- 用人单位-->
							<p>临时工</p> <!-- 兼职名称 -->
							<p>2015-8-1</p> <!-- 兼职名称 -->
					</a></li>

					<li data-icon="false"><a onclick="openWork(this)" workid="12"
						style="padding-top: 0px; padding-bottom: 0px;"> <img
							src="http://image.zhangxinxu.com/image/study/s/s128/mm5.jpg">
							<h2>臻洪</h2> <!-- 用人单位-->
							<p>临时工</p> <!-- 兼职名称 -->
							<p>2015-8-1</p> <!-- 兼职名称 -->
					</a></li>
				</ul>
			</div>
			<div id="reqworkList">
				<ul data-role="listview" id="reqWorkListUL">
					<li data-icon="false"><a onclick="openWork(this)" workid="1"
						style="padding-top: 0px; padding-bottom: 0px;"> <img
							src="http://image.zhangxinxu.com/image/study/s/s128/mm5.jpg">
							<h2>臻洪</h2> <!-- 用人单位-->
							<p>临时工</p> <!-- 兼职名称 -->
							<p>2015-8-1</p> <!-- 兼职名称 -->
					</a></li>

					<li data-icon="false"><a onclick="openWork(this)" workid="12"
						style="padding-top: 0px; padding-bottom: 0px;"> <img
							src="http://image.zhangxinxu.com/image/study/s/s128/mm5.jpg">
							<h2>臻洪</h2> <!-- 用人单位-->
							<p>临时工</p> <!-- 兼职名称 -->
							<p>2015-8-1</p> <!-- 兼职名称 -->
					</a></li>
				</ul>
			</div>
		</div>

	</div>
</body>
</html>