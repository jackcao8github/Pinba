<!DOCTYPE html>
<html manifest="../pinba.appcache">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width" />

<link rel="stylesheet" href="../css/jquery.mobile-1.4.5.css" />
<link rel="stylesheet" href="../mycss/mygrid.css" />
<link rel="stylesheet" href="../css/font-awesome.css" />
<script src="../js/jquery-1.11.3.js"></script>
<script src="../js/jquery.mobile-1.4.5.js"></script>
<script src="../myjs/mycommon.js"></script>
<script type="text/javascript" src="../myjs/myswipe.js"></script>

<script type="text/javascript">
	$(document).ready(function() {
		pageInit();
	});
	var userId = 0;
	function pageInit(){
		var cachedUserInfo = getLoginUserInfo();
        if (cachedUserInfo != null) {
            var userInfo = {};
            userId = cachedUserInfo.userId;
            userInfo.userId = cachedUserInfo.userId;
            ajaxReq('userAction', {
                method : 'getUserInfo',
                userInfo : json2Str(userInfo)
            }, function(data) {
                if (data.flag == 'success') {//登陆成功后返回主页面
                    bindData(data,'userInfoDiv');
                } else {
                    alert(data.msg);
                    return false;
                }
            });
        }
	}
	//绑定数据到控件
    function bindData(jsonData,divId) {
        for ( var o in jsonData) {
            var ctrl = $('#'+divId+' #' + o);
            if (ctrl.length > 0) {
                //处理下拉框采集的数据
                var realValue = jsonData[o];
                var displayValue = getDisplayEnumValue(o, realValue);
                ctrl.html(displayValue);
            }
        }
    }
	
    function modUserInfo(){
        changeSubPage('changePrivateUserInfo', 'userInfoPage', 'userId=' + userId);
    }
	function logout() {
		localStorage.removeItem("userInfo");

		closeSubPage();
	}

	function swipeRight() {
		closeSubPage();
	}
</script>
</head>
<body>
	<div data-role="page" id="userInfoPage">

		<div data-role="header">
			<a href="#" data-rel="back" class="ui-btn ui-btn-left ui-alt-icon ui-nodisc-icon ui-corner-all ui-btn-icon-notext ui-icon-carat-l"
				onclick="closeSubPage();return false;">Back</a>
			<h1>用户信息</h1>
			<a onclick="modUserInfo()" id="modBtn"
                class="ui-btn ui-corner-all ui-shadow ui-btn-icon-left ui-icon-edit">修改用户信息</a>
		</div>
		<div class="login">
			<img src="http://image.zhangxinxu.com/image/study/s/s128/mm5.jpg"
				alt="" class="personal_logo" onclick="changeHeadPic()">
		</div>
		<!-- 第一块 -->
		<div class="firstblock">
			<ul data-role="listview" data-mini="true"  id="userInfoDiv">
				<li data-icon="false" ><a href="#">昵称 <span class="ui-li-count" id="userName"></span></a></li>
				<li data-icon="false" ><a href="#">性别 <span class="ui-li-count" id="sex"></span></a></li>
				<li data-icon="false" ><a href="#">年龄 <span class="ui-li-count" id="age"></span></a></li>
				<li data-icon="false" ><a href="#">手机 <span class="ui-li-count" id="cellphone"></span></a></li>
				<li data-icon="false" ><a href="#">邮箱 <span class="ui-li-count" id="email"></span></a></li>
			</ul>

			<div class="h1"></div>
			<a data-role="button" style="background: red" onclick="logout()">退出当前帐户</a>
		</div>

	</div>
</body>
</html>