<!DOCTYPE html>
<html manifest="../pinba.appcache">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1, user-scalable=no" />


<link rel="stylesheet" href="../css/font-awesome.min.css" />
<link rel="stylesheet" href="../mycss/mygrid.css" />

<script src="../js/jquery-1.11.3.min.js"></script>
<link rel="stylesheet" href="../css/font-awesome.min.css" /><link rel="stylesheet" href="../css/bootstrap.min.css" />

<style type="text/css">
li {
	padding: 0em 1em
}
</style>

</head>
<body>
	<div data-role="page" id="workdetailPage">
		<!-- 返回按钮 -->
		<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
			<div class="navbar-header">
			<a onclick="modResume()" id="modBtn" style="display:none"
				class="ui-btn ui-corner-all ui-shadow ui-btn-icon-left ui-icon-edit">修改简历</a>
				<a class="navbar-brand" href="#"
					onclick="closeSubPage();return false;"><i
					class="fa fa-close fa-lg"></i></a> <a class="navbar-brand">兼职简历</a>
			</div>
		</nav>
		
		
		<ul class="list-group">
			<li data-role="list-divider">基本信息</li>
			<li class="list-group-item" style="padding: 0em 1em">
				<div style="overflow: hidden">
					<div style="float: left; width: 30%; color: #a3a3a3">
						<p>姓名:</p>
					</div>
					<div style="float: left; width: 70%">
						<p id="realName"></p>
					</div>
				</div>
				<div style="overflow: hidden">
					<div style="float: left; width: 30%; color: #a3a3a3">
						<p>性别:</p>
					</div>
					<div style="float: left; width: 70%">
						<p id="sex"></p>
					</div>
				</div>
				<div style="overflow: hidden">
					<div style="float: left; width: 30%; color: #a3a3a3">
						<p>年龄:</p>
					</div>
					<div style="float: left; width: 70%">
						<p id="age"></p>
					</div>
				</div>
				<div style="overflow: hidden">
					<div style="float: left; width: 30%; color: #a3a3a3">
						<p>工作经验:</p>
					</div>
					<div style="float: left; width: 70%">
						<p id="experience"></p>
					</div>
				</div>
				<div style="overflow: hidden">
					<div style="float: left; width: 30%; color: #a3a3a3">
						<p>学历:</p>
					</div>
					<div style="float: left; width: 70%">
						<p id="degree"></p>
					</div>
				</div>
				<div style="overflow: hidden">
					<div style="float: left; width: 30%; color: #a3a3a3">
						<p>期望区域:</p>
					</div>
					<div style="float: left; width: 70%">
						<p id="expectWorkArea"></p>
					</div>
				</div>

				<div style="overflow: hidden">
					<div style="float: left; width: 30%; color: #a3a3a3">
						<p>期望职位:</p>
					</div>
					<div style="float: left; width: 70%">
						<p id="expectPost"></p>
					</div>
				</div>
				<div style="overflow: hidden">
					<div style="float: left; width: 30%; color: #a3a3a3">
						<p>手机:</p>
					</div>
					<div style="float: left; width: 70%">
						<p id="cellphone"></p>
					</div>
				</div>
				<div style="overflow: hidden">
					<div style="float: left; width: 30%; color: #a3a3a3">
						<p>邮箱:</p>
					</div>
					<div style="float: left; width: 70%">
						<p id="email"></p>
					</div>
				</div>
			</li>
			<li data-role="list-divider">期望待遇</li>
			<li class="list-group-item" style="padding: 0em 1em">
				 <div style="overflow: hidden">
                    <div style="float: left; width: 30%; color: #a3a3a3">
                        <p>薪资单位:</p>
                    </div>
                    <div style="float: left; width: 70%">
                        <p id="sallaryType"></p>
                    </div>
                </div>
                <div style="overflow: hidden">
                    <div style="float: left; width: 30%; color: #a3a3a3">
                        <p>薪资金额:</p>
                    </div>
                    <div style="float: left; width: 70%">
                        <p id="sallaryValue"></p>
                    </div>
                </div>
				<div style="overflow: hidden">
					<div style="float: left; width: 30%; color: #a3a3a3">
						<p>工资当天结算:</p>
					</div>
					<div style="float: left; width: 70%">
						<p id="dayCharge"></p>
					</div>
				</div>
				<div style="overflow: hidden">
					<div style="float: left; width: 30%; color: #a3a3a3">
						<p>提供食宿:</p>
					</div>
					<div style="float: left; width: 70%">
						<p id="foodAndLodging"></p>
					</div>
				</div>
			</li>
			<li data-role="list-divider">工作经历</li>
			<li class="list-group-item" style="padding: 0em 1em">
				<p style="white-space: pre-line;" id="workHisList"></p>
			</li>

			<li data-role="list-divider">教育经历</li>
			<li class="list-group-item" style="padding: 0em 1em">
				<p style="white-space: pre-line;" id="eduHisList"></p>
			</li>
			<li data-role="list-divider">自我评价</li>
			<li class="list-group-item" style="padding: 0em 1em">
				<p style="white-space: pre-line;" id="selfReview"></p>
			</li>
		</ul>


		<div data-role="footer" data-position="fixed" data-fullscreen="false"
			data-tap-toggle="false" id="footer">
			<div data-role="controlgroup" data-type="horizontal">
			<a href="#" role="button" data-icon="plus" onclick="addFocus()">关注</a>
			<a href="#" role="button" data-icon="phone" id="cellphone" onclick="toDial()">联系TA</a>
			<a href="#" id="sendMsg" role="button" data-icon="mail" onclick="toSendMsg()">私信</a>
			</div>
		</div>
	</div>
</body>


<script type="text/javascript" src="../myjs/mycommon.js"></script>
<script type="text/javascript" src="../myjs/myswipe.js"></script>
<script type="text/javascript">
	function swipeRight() {
		closeSubPage();
	}
	var resumeId = 0;
	var userId = 0;
	var resumeUserId = 0;
	$(document).ready(function() {
		
		pageInit();
	});

	function pageInit() {
		var mode = getQueryString('mode');
        if (mode == 'intergration') {//表示此页面被嵌入到其它页面里,header和footer要去掉
            $('#header').remove();
            $('#footer').remove();
        }
		resumeId = getQueryString('resumeId');
		if (resumeId == null) {
			showTipDialog('参数reusmeId为空!');
			return;
		}
		var resumeInfo = {};
		if (resumeId > 0) {
			resumeInfo.resumeId = resumeId;
		}
		var cachedUserInfo = str2Json(localStorage.userInfo);
		if (cachedUserInfo != null) {
			resumeInfo.userToken = cachedUserInfo.userToken;
			resumeInfo.readUserId = cachedUserInfo.userId;
			userId = cachedUserInfo.userId;
		} else {
			userId = 0;
		}
		ajaxReq('resumeAction', {
			method : 'getResumeInfo',
			resumeInfo : json2Str(resumeInfo)
		}, function(data) {
			if (data.flag == 'success') {
				bindData(data);
				//如果不是简历所有者，需要删除修改简历按钮
				resumeUserId = data.userId;
				if (userId == resumeUserId) {
					$('#footer').remove();
					$('#modBtn').show();
				} else {
					$('#modBtn').remove();
				}
			} else {
				showTipDialog(data.msg);
				return false;
			}
		});
	}
	/* 修改简历 */
	function modResume() {
		changeSubPage('resume', 'workdetailPage', 'resumeId=' + resumeId);
	}
	/* 增加关注 */
	function addFocus() {
		showTipDialog('建设中');
	}
	//拔打电话
	function toDial(){
		if (window.sysFunc!=null){//sysFunc在android代码中使用webview.addJavascriptInterface(new SysFuncAgent(), "sysFunc")创建
			var cellphone = $('#cellphone').html();
			window.sysFunc.call(cellphone);
		}
	}
	
	/* 发送私信 */
	function toSendMsg(){
		var user = getLoginUserInfo();
		if (user!=null){
			var params = 'friendId=' + resumeUserId;
			params += '&friendName=';
			params += $('#realName').html();
			params += '&friendHeadImageId=1';
			params += '&msgType=friendMsg';
			changeSubPage('friendsMsg', 'workdetailPage', params);
		}
	}
	//绑定数据到控件
	function bindData(jsonData) {
		for ( var o in jsonData) {
			var ctrl = $('#' + o);
			if (ctrl.length > 0) {
				//处理下拉框采集的数据
				var realValue = jsonData[o];
				var displayValue = getDisplayEnumValue(o, realValue);
				if (displayValue == realValue) {//没有显示值则用realValue显示
					ctrl.html(realValue);
				} else {
					ctrl.html(displayValue);
				}
			}
		}
	}
</script>
</html>